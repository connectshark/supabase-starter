import{a as v,i as w}from"./useGallery.eb4442d7.js";import{u as y,r as x,o as a,c as n,a as e,F as d,p as u,g as k,k as I,s as j}from"./index.bb664abf.js";const C={class:"max-w-lg mx-auto p-10"},P=e("h2",{class:"text-xl leading-loose"},"\u5DF2\u4E0A\u50B3\u5716\u7247\u5340",-1),B={class:"border-b border-stone-600 pb-5 mb-5 grid grid-cols-3"},D={class:"pt-[100%] relative"},E=["src"],F={class:"block bg-stone-300 py-10 mb-10 rounded cursor-pointer"},L=e("div",{class:"text-center text-lg"},"\u4E0A\u50B3\u5716\u7247",-1),V={class:"grid grid-cols-2 gap-4"},A={class:"shadow-md rounded-br-3xl"},N={class:"pt-[100%] relative"},R=["src"],U={class:"px-4 py-8"},G=["onClick"],O={key:0,class:"p-8 text-right"},H={__name:"AddImgView",setup(S){const i=y(),{loading:$,list:p,reload:_}=v({id:i.id}),g=new w({clientId:"3466d7179394743"}),m=async()=>{const s=[];for(let o=0;o<l.value.length;o++){const r=l.value[o].slice(22),{data:{link:c}}=await g.upload({type:"base64",image:r});s.push({img_url:c,owner_id:i.id})}await j.from("gallery").insert(s),_()},h=s=>{l.value.splice(s,1)},l=x([]),b=async s=>{const o=s.target.files;Object.values(o).forEach(async t=>{await f(t)})},f=s=>new Promise(o=>{const t=new FileReader;t.addEventListener("load",r=>{l.value.push(r.target.result),o()}),t.readAsDataURL(s)});return(s,o)=>(a(),n("div",C,[P,e("ul",B,[(a(!0),n(d,null,u(k(p),t=>(a(),n("li",{key:t.id},[e("figure",D,[e("img",{class:"w-full object-contain absolute top-0 left-0 h-full",src:t.img_url,alt:""},null,8,E)])]))),128))]),e("label",F,[L,e("input",{type:"file",class:"hidden",accept:".jpg, .jpeg, .png",multiple:"",onChange:b},null,32)]),e("ul",V,[(a(!0),n(d,null,u(l.value,(t,r)=>(a(),n("li",A,[e("figure",N,[e("img",{class:"w-full object-contain absolute top-0 left-0 h-full",src:t,alt:""},null,8,R)]),e("div",U,[e("button",{onClick:c=>h(r),class:"font-bold hover:opacity-80 text-white bg-primary leading-loose rounded-xl w-10",type:"button"},"\u522A\u9664",8,G)])]))),256))]),l.value.length>0?(a(),n("div",O,[e("button",{onClick:m,class:"text-md font-bold hover:opacity-80 text-white bg-primary py-4 w-24 rounded-full",type:"button"},"\u4E0A\u50B3\u5716\u7247")])):I("",!0)]))}};export{H as default};
